---
layout: post
title:  凯利公式
categories: math
mathjax: true
---
假如你拿了1万块钱去参与一种赌博，随便你下注几块钱，如果赢了就给你翻倍，如果输了就没了，现在假设胜率有60%，那么每次应该下注多少钱才能获得最大的收益呢？

傻逼兮兮的人可能一次就梭哈了，反正赢的概率多过输的概率嘛。但是还是有40%的概率一下就输光了。

假设我们每次按余下本金的一定比例下注，这个比例应该是多少合适呢？假设我们赌了100次，那么大概赢了60次，输了40次，设比例为$x$，则盈利

$f(x)=10000*(1+x)^{60} *(1-x)^{40}$

需要求它的最大值。

一般的，假设每投入1，可能获得额外收益W，或者失去本金L，胜率为p，败率为q，则期望收益

$$f(x)=(1+Wx)^{p} (1-Lx)^{q} $$

为了求它的最大值，先求个导数。

$$f^{'}(x)=Wp(1+Wx)^{p-1} (1-Lx)^{q} -L(1-p)(1+Wx)^{p} (1-Lx)^{q-1}=0$$

不难求得

$$x=\frac {bp-q} {bL}$$

当L=1时，即一输就输光时，这个公式称为凯利公式。对本文开头的问题，p=0.6,q=0.4,b=1, 可以算出x=20%。所以，应该每次投入现有本金的20%。假设胜率为0.9，则x=0.8。假设胜率为0.5，则x=0，永远不要参与对半开的赌博，如果胜率小于0.5，就更不能参加了。

凯利公式只是一个近似，它有很多假设，假设可以多次博弈，假设资金无限可分，假设胜率稳定，和投资活动有很多去呗，但还是给我们进行投资提供了一个大致的估算工具，从凯利公司的角度来看，保留一定的现金留作翻本是很有必要的。概率计算在投资中很有必要，虽然投资中盈利的概率估算本身也算是玄学了，但是正如格雷厄姆说的，我们不能因为定量计算很困难就放弃定量计算。
